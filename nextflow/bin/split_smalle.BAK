#!/usr/bin/env python3

import numpy as np
import cv2
import argparse
import time

# Construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-p", "--path", required=False, default='.',
        help="path to video file not including filename. Default is ./")
ap.add_argument("-v", "--video", required=True, type=str,
        help="file name for first video")
ap.add_argument("-s", "--start", required=False, default=1, type=int,
        help="frame to start at default = 1")
ap.add_argument("-d", "--delay", required=False, default=0, type=float,
        help="delay time between frames for slo-mo")
args = vars(ap.parse_args())
start = args["start"]
dir_path = args["path"]
video = args["video"]


# Open the input video
input_video_path = video  # Replace with your video file path
cap = cv2.VideoCapture(input_video_path)

# Get the width and height of the video frames
frame_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))
frame_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))

# Calculate the width of the left and right halves
half_width = frame_width // 2

# Define the codec and create VideoWriter objects
fourcc = cv2.VideoWriter_fourcc(*'mp4v')  # You can change the codec if needed
left_output_path = 'left_half_video.mp4'
right_output_path = 'right_half_video.mp4'
left_out = cv2.VideoWriter(left_output_path, fourcc, 30.0, (half_width, frame_height))
right_out = cv2.VideoWriter(right_output_path, fourcc, 30.0, (half_width, frame_height))

# Process each frame
while cap.isOpened():
    ret, frame = cap.read()
    if not ret:
        break
    
    # Split the frame into left and right halves
    left_half = frame[:, :half_width]
    right_half = frame[:, half_width:]
    
    # Write the halves to their respective video files
    left_out.write(left_half)
    right_out.write(right_half)

# Release everything
cap.release()
left_out.release()
right_out.release()
cv2.destroyAllWindows()
